# ![icons8gurupng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-12-52-icons8-guru.png)B√†i t·∫≠p C√°c c√¢u l·ªánh SQL ![icons8-2_cute.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-13-46-27-icons8-2_cute.png)

## ![icons8-database_view.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-13-17-41-icons8-database_view.png) 1.Ta c√≥ b·∫£ng danh s√°ch c√¥ng tr√¨nh nh∆∞ sau :

| KienTrucSu                                                                                                                       | ChuThau                                                                                                                           | ChuNhan                                                                                                                             | CongNhan                                                                                                                              | CongTrinh                                                                                                                              | ThamGia                                                                                                                                | ThietKe                                                                                                                                |
| -------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| MSKTS ![icons8redsquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-03-33-icons8-red_square.png) | MSCT ![icons8bluesquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-03-59-icons8-blue_square.png) | MSCH ![icons8brownsquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-10-46-icons8-brown_square.png) | MSCN ![icons8yellowsquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-04-23-icons8-yellow_square.png) | STTCT ![icons8purplesquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-10-02-icons8-purple_square.png) | MSCN ![icons8yellowsquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-04-23-icons8-yellow_square.png)  | MSKTS ![icons8redsquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-03-33-icons8-red_square.png)       |
| HoTenKTS                                                                                                                         | TenThau                                                                                                                           | TenChu                                                                                                                              | HoTenCN                                                                                                                               | TenCT                                                                                                                                  | STTCT ![icons8purplesquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-10-02-icons8-purple_square.png) | STTCT ![icons8purplesquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-10-02-icons8-purple_square.png) |
| NamSinhKTS                                                                                                                       | DienThoai                                                                                                                         | DiaChiChu                                                                                                                           | NamSinhCN                                                                                                                             | DiaChiCT                                                                                                                               | NgayTG                                                                                                                                 | ThuLao                                                                                                                                 |
| Phai                                                                                                                             | DiachiThau                                                                                                                        |                                                                                                                                     | NamVaoNghe                                                                                                                            | TinhThanh                                                                                                                              | SoNgay                                                                                                                                 |                                                                                                                                        |
| NoiTN                                                                                                                            |                                                                                                                                   |                                                                                                                                     | ChuyenMon                                                                                                                             | KinhPhi                                                                                                                                | S                                                                                                                                      |                                                                                                                                        |
| DiachiKTS                                                                                                                        |                                                                                                                                   |                                                                                                                                     |                                                                                                                                       | MSCH ![icons8brownsquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-10-46-icons8-brown_square.png)    |                                                                                                                                        |                                                                                                                                        |
|                                                                                                                                  |                                                                                                                                   |                                                                                                                                     |                                                                                                                                       | MSCT ![icons8bluesquarepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/21-18-03-59-icons8-blue_square.png)      |                                                                                                                                        |                                                                                                                                        |
|                                                                                                                                  |                                                                                                                                   |                                                                                                                                     |                                                                                                                                       | NgayBD                                                                                                                                 |                                                                                                                                        |                                                                                                                                        |

> ![icons8howquestpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-13-09-24-icons8-how_quest.png) C√°ch b∆∞·ªõc chu·∫©n b·ªã t√†i nguy√™n nh∆∞ sau :
> 
> - ![icons8downloadpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-13-00-54-icons8-download.png) **B1**: Download `Database` **c√¥ng tr√¨nh** [t·∫°i ƒë√¢y](https://github.com/Zenfection/CTU/raw/main/HocPhan/CT180-Co_so_du_lieu/Baitap/2.Cau_lenh_SQL/congtrinh.bak)
> 
> - ![icons8restorepng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-13-01-06-icons8-restore.png) **B2**: Restore file `congtrinh.bak` [nh∆∞ sau](https://www.youtube.com/watch?v=oo4C-As6caI)
> 
> - ![icons8landlordpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-13-01-39-icons8-landlord.png) **B3**: Thi·∫øt l·∫≠p ch·ªß s·ªü h·ªØu cho `database` v·ª´a **Restore** ƒë·ªÉ c√≥ th·ªÉ d√πng ƒë∆∞·ª£c t√≠nh nƒÉng nh∆∞ `Database Diagram` ==> l√†m [nh∆∞ sau](https://www.youtube.com/watch?v=Xbxu2hrssHk)

---

## <img title="" src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-15-19-04-icons8-questionnaire.png" alt="icons8-questionnaire.png" width="40"> 2.Danh s√°ch c√°c c√¢u h·ªèi

| ![icons8googlecode30pxpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/08-10-24-29-icons8_google_code_30px.png) Source Code |
| ------------------------------------------------------------------------------------------------------------------------------------------------- |
| [query_2.sql](https://github.com/Zenfection/CTU/blob/main/HocPhan/CT180-Co_so_du_lieu/Baitap/2.Cau_lenh_SQL/bai2/query_2.sql)                     |

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 1**: Cho bi·∫øt **h·ªç t√™n** c√°c `ki·∫øn tr√∫c s∆∞` v·ª´a `thi·∫øt k·∫ø` c√°c `c√¥ng tr√¨nh` do `ch·ªß th·∫ßu` *Ho√†ng Xu√¢n B√¨nh* thi c√¥ng, v·ª´a `thi·∫øt k·∫ø` c√°c `c√¥ng tr√¨nh` do `ch·ªß th·∫ßu` *L√™ VƒÉn S∆°n* thi c√¥ng

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql
SELECT KTS.HOTENKTS
FROM dbo.congtrinh as CongT, dbo.chuthau as ChuT,dbo.kientrucsu as KTS, dbo.thietke as TK
WHERE TK.MSKTS = KTS.MSKTS
AND TK.STTCT = CongT.STTCT
AND ChuT.MSCT = CongT.MSCT
AND ChuT.TENTHAU = 'hoang cong binh'

INTERSECT

SELECT KTS.HOTENKTS
FROM dbo.congtrinh as CongT, dbo.chuthau as ChuT,dbo.kientrucsu as KTS, dbo.thietke as TK
WHERE TK.MSKTS = KTS.MSKTS
AND TK.STTCT = CongT.STTCT
AND ChuT.MSCT = CongT.MSCT
AND ChuT.TENTHAU = 'le van son'
```

‚á®  `3` records

---

</details>

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 2**: Cho bi·∫øt **t√™n** `c√¥ng tr√¨nh` c√≥ **kinh ph√≠** *cao nh·∫•t*

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql
DECLARE @MaxKINHPHI INT

SELECT  @MaxKINHPHI = MAX(KINHPHI) FROM dbo.congtrinh
SELECT TENCT
FROM dbo.congtrinh
WHERE KINHPHI = @MaxKINHPHI
```

‚á®  `1` record

---

</details>

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 3**: Cho bi·∫øt **h·ªç t√™n** c√°c `c√¥ng nh√¢n` c√≥ `tham gia` c√°c `c√¥ng tr√¨nh` ·ªü *C·∫ßn th∆°*, nh∆∞ng <u>kh√¥ng c√≥</u> `tham gia` `c√¥ng tr√¨nh` ·ªü *Vƒ©nh Long*

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql
SELECT CN.HOTENCN
FROM dbo.congnhan as CN, dbo.congtrinh as CongT, dbo.thamgia as TG
WHERE TG.STTCT = CongT.STTCT
AND TG.MSCN = CN.MSCN
AND CongT.TINHTHANH = 'can tho'

EXCEPT

SELECT CN.HOTENCN
FROM dbo.congnhan as CN, dbo.congtrinh as CongT, dbo.thamgia as TG
WHERE TG.STTCT = CongT.STTCT
AND TG.MSCN = CN.MSCN
AND CongT.TINHTHANH = 'vinh long'
```

‚á®  `11` records

---

</details>

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 4**: Cho bi·∫øt **h·ªç t√™n** c·ªßa c√°c `ch·ªß th·∫ßu` ƒë√£ thi c√¥ng c√°c `c√¥ng tr√¨nh` c√≥ **kinh ph√≠** <u>l·ªõn h∆°n t·∫•t c·∫£</u> c√°c **kinh ph√≠** c·ªßa `c√¥ng tr√¨nh` do `ch·ªß th·∫ßu` l√† *Ho√†ng C√¥ng B√¨nh* thi c√¥ng

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql
DECLARE @MaxKINHPHI_hoangcongbinh INT

SELECT @MaxKINHPHI_hoangcongbinh = MAX(CONVERT(int, CongT.KINHPHI))
FROM dbo.congtrinh as CongT, dbo.chuthau as ChuT,dbo.thamgia as TG
WHERE TG.STTCT = CongT.STTCT
AND ChuT.MSCT = CongT.MSCT
AND ChuT.TENTHAU = 'hoang cong binh'

SELECT DISTINCT ChuT.TENTHAU
FROM dbo.congtrinh as CongT, dbo.chuthau as ChuT,dbo.thamgia as TG
WHERE TG.STTCT = CongT.STTCT
AND ChuT.MSCT = CongT.MSCT
AND CongT.KINHPHI > @MaxKINHPHI_hoangcongbinh
```

> üí° D√πng `CONVERT` chuy·ªÉn sang `int` v√¨ `CongT.KINHPHI` l√† `nvarchar`

‚á®  `2` records

---

</details>

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 5**: Cho bi·∫øt **h·ªç t√™n** c√°c `ki·∫øn tr√∫c s∆∞` c√≥ **th√π lao** `thi·∫øt k·∫ø` cho m·ªôt `c√¥ng tr√¨nh` nao ƒë√≥ <u>d∆∞·ªõi <strong>th√π lao</strong> trung b√¨nh</u> c·ªßa <u>t·∫•t c·∫£</u> c√°c `c√¥ng tr√¨nh`

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql
DECLARE @AVG_THULAO INT

SELECT @AVG_THULAO = AVG(CONVERT(int, THULAO))
FROM dbo.thietke as TK,dbo.kientrucsu as KTS,dbo.congtrinh as CongT
WHERE TK.MSKTS = KTS.MSKTS
AND TK.STTCT = CongT.STTCT

SELECT DISTINCT KTS.HOTENKTS
FROM dbo.thietke as TK,dbo.kientrucsu as KTS,dbo.congtrinh as CongT
WHERE TK.MSKTS = KTS.MSKTS
AND TK.STTCT = CongT.STTCT
AND TK.THULAO < @AVG_THULAO
```

> üí° D√πng `CONVERT` chuy·ªÉn sang `int` v√¨ `TK.THULAO` l√† `nvarchar`

‚á®  `9` records

---

</details>

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 6**: Cho bi·∫øt **h·ªç t√™n** v√† **ƒë·ªãa ch·ªâ** nh·ªØng `ch·ªß th·∫ßu` l√† `ch·ªß th·∫ßu` c·ªßa c√°c `c√¥ng tr√¨nh` c√≥ **kinh ph√≠** <u>th·∫•p nh·∫•t</u>.

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql
DECLARE @Min_KINHPHI INT

SELECT @Min_KINHPHI = MIN(CONVERT(int, CongT.KINHPHI))
FROM dbo.congtrinh as CongT, dbo.chuthau as ChuT
WHERE ChuT.MSCT = CongT.MSCT

SELECT ChuT.TENTHAU,ChuT.DIACHITHAU
FROM dbo.congtrinh as CongT, dbo.chuthau as ChuT
WHERE ChuT.MSCT = CongT.MSCT
AND CongT.KINHPHI = @Min_KINHPHI
```

‚á®  `1` records

---

</details>

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 7**: Cho bi·∫øt **h·ªç t√™n** v√† **chuy√™n m√¥n** c·ªßa c√°c `c√¥ng nh√¢n` `tham gia` c√°c `c√¥ng tr√¨nh` do `ki·∫øn tr√∫c s∆∞` *L√™ Thanh T√πng* `thi·∫øt k·∫ø`

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql
SELECT DISTINCT CN.HOTENCN, CN.CHUYENMON
FROM dbo.kientrucsu as KTS,dbo.congtrinh as CongT, dbo.congnhan as CN, dbo.thietke as TK, dbo.thamgia as TG
WHERE TK.MSKTS = KTS.MSKTS
AND TK.STTCT = CongT.STTCT
AND TG.MSCN = CN.MSCN
AND TG.STTCT = CongT.STTCT
AND KTS.HOTENKTS = 'le thanh tung';
```

‚á®  `59` records

---

</details>

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 8**: Cho bi·∫øt c√°c <u>c·∫∑p</u> **h·ªç t√™n** c·ªßa c√°c `ch·ªß th·∫ßu` l√† `ch·ªß th·∫ßu` c·ªßa c√°c `c√¥ng tr√¨nh` t·∫°i c√πng m·ªôt **t·ªânh th√†nh** n√†o ƒë√≥. 

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql

```

‚á®  

---

</details>

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 9**: Cho bi·∫øt c√°c <u>c·∫∑p</u> **h·ªç t√™n** c·ªßa c√°c `c√¥ng nh√¢n` c√≥ `tham gia` chung v·ªõi nhau <u>√≠t nh·∫•t</u> **2** `c√¥ng tr√¨nh`

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql

```

‚á®  

---

</details>

> ![icons8questionspng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-08-59-15-icons8-questions.png) **C√¢u 10**: Cho bi·∫øt **h·ªç t√™n** `c√¥ng nh√¢n` `tham gia` c√°c `c√¥ng tr√¨nh` c√≥ **kinh ph√≠** <u>l·ªõn h∆°n</u> **kinh ph√≠** <u>trung b√¨nh</u> c·ªßa c√°c `c√¥ng tr√¨nh`

<details>
<summary><b><img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/08-16-44-05-icons8-consultation.png" width ="40"> Gi·∫£i</b></summary>

<br>

```sql
DECLARE @AVG_KINHPHI INT

SELECT @AVG_KINHPHI = AVG(CONVERT(int, CongT.KINHPHI))
FROM dbo.congtrinh as CongT, dbo.congnhan as CN, dbo.thamgia as TG
WHERE TG.MSCN = CN.MSCN
AND TG.STTCT = CongT.STTCT

SELECT DISTINCT CN.HOTENCN
FROM dbo.congtrinh as CongT, dbo.congnhan as CN, dbo.thamgia as TG
WHERE TG.MSCN = CN.MSCN
AND TG.STTCT = CongT.STTCT
AND CongT.KINHPHI > @AVG_KINHPHI
```

> üí° D√πng `CONVERT` chuy·ªÉn sang `int` v√¨ `CongT.KINHPHI` l√† `nvarchar`

‚á® `51` records

---

</details> 
